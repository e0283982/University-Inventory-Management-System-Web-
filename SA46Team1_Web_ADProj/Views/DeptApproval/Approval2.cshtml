@{
    Layout = null;
}

<link href="@Url.Content("~/Content/common.css")" rel="stylesheet" type="text/css" />

<script>
 var table;
    $(document).ready(function () {

        $.ajax({
            url: 'http://localhost:49921/api/Restful/GetPendingApprovalsById/' + '@Session["ReviewNewRequisitionId"]',
            method: 'get',
            dataType: 'json',
            success: function (data) {
                table = $('#dataTable-approval-details').DataTable({
                    paging: true,
                    sort: true,
                    searching: true,
                    scrollY: 200,
                    data: data,
                    responsive: true,
                    columns: [
                        { 'data': 'ItemDesc' },
                        { 'data': 'UOM' },
                        { 'data': 'OrderQty' }
                    ],
                });
            }
        });
    });

    $(function () {
        $("#dialog-approve-req-form").dialog({
            autoOpen: false
        });
    });

    $('#btn-approve-req-form').click(function () {
        $.ajax({
            url: '/DeptApproval/Approve',
            type: 'POST',
        });

        table.draw(false);

        $('#dialog-approve-req-form').dialog('open');
        window.location.href = '@Url.Action("Approval", "Dept")';

        return false;
    });

    $(function () {
        $("#dialog-reject-req-form").dialog({
            autoOpen: false
        });
    });

    $('#btn-reject-req-form').click(function () {
        $.ajax({
            url: '/DeptApproval/Reject',
            type: 'POST',
        });

        table.draw(false);

        $('#dialog-reject-req-form').dialog('open');
        window.location.href = '@Url.Action("Approval", "Dept")';

        return false;
    });
</script>

<div>
    <h2>Requisition Approval</h2>
    <h3>Requisition Form @Session["ReviewNewRequisitionId"]</h3>
</div>


<table id="dataTable-approval-details" class="display" style="width:80%;">
    <thead>
        <tr>
            <th>Item Description</th>
            <th>Unit of Measure</th>
            <th>Order Qty</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th></th>
            <th></th>
            <th></th>
        </tr>
    </tbody>
</table>

<div>
    <p>Requested By: @TempData["RequisitionRequstor"]  </p>
    <p>Requested Date:  @TempData["RequisitionDateReq"]  </p>
</div>

<div>
    <p>Remarks:</p>
    <textarea rows="4" cols="50">
    </textarea>
</div>

<div id="btns-grp-btm">
    <button class="btn-blue" id="btn-reject-req-form">Reject</button>
    <div id="dialog-reject-req-form" class="hidden" title="Reject Requisition">
        <p>The displayed Stationary request has been rejected.</p>
    </div>

    <button class="btn-blue" id="btn-approve-req-form">Approve</button>
    <div id="dialog-approve-req-form" class="hidden" title="Approve Requisition">
        <p>The displayed Stationary request has been approved.</p>
    </div>
</div>

<div id="details-back-btn">

    @using (Html.BeginForm("BackToApprovalList", "DeptApproval", FormMethod.Post))
    {
        <input class="btn-blue" type="submit" value="Back" />
    }
</div>


<style>
    #btns-grp-btm {
        margin-right: 10vw;
    }
</style>